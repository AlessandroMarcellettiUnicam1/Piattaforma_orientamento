<div class="container">
  <div class="title-container">
    <h2 class="title">Statistiche</h2>
  </div>
  <div class="wrapper">
    <div class="bottoni">
      <button mat-button class="btn1" id="btn1" (click)="onClick1()">
        Vista scuole
      </button>
      <button mat-button class="btn2" id="btn2" (click)="onClick2()">
        Vista attività
      </button>
      <button mat-button class="btn3" id="btn3" (click)="onClick3()">
        Vista Professori Scuole
      </button>
      <button mat-button class="btn4" id="btn4" (click)="onClick4()">
        Vista Professori Unicam
      </button>
    </div>

    <div class="filter">
      <div class="filter-view" *ngIf="isFilterOpened">
        <mat-form-field class="year-filter" *ngIf="click < 3">
          <mat-label>Seleziona anno </mat-label>
          <mat-select (selectionChange)="cambioRisultati($event.value)">
            <mat-option>-</mat-option>
            <mat-option class="year-filter-option" *ngFor="let an of anni" [value]="an.value">
              {{ an.viewValue }}
            </mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field class="view-filter" *ngIf="click == 0 || click == 1">
          <mat-label>Ordinamento vista</mat-label>
          <mat-select class="view-filter-option" (selectionChange)="cambioOrdinamento($event.value)">
            <mat-option>-</mat-option>
            <mat-option value="ISCRITTI">Per numero di iscritti</mat-option>
            <mat-option value="REGIONI">Alfabetico per regione</mat-option>
            <mat-option value="SCUOLE">Alfabetico per le scuole</mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field *ngIf="click == 2">
          <mat-label>Ordinamento vista</mat-label>
          <mat-select class="view-filter-option" (selectionChange)="cambioOrdinamentoAtt($event.value)">
            <mat-option>-</mat-option>
            <mat-option value="ISCRITTI">Per numero di iscritti</mat-option>
            <mat-option value="NOME">Alfabetico per attività</mat-option>
          </mat-select>
        </mat-form-field>
      </div>
    </div>
  </div>

  <div class="generato">
    <div class="spazio" *ngIf="click == 1">
      <div class="school-button">
        <button class="button-download" id="scaricaScuoleButton" (click)="scaricaVistaScuole()">
          <span class="button-content">Scarica Vista Scuole </span>
        </button>
      </div>

      <div class="school-results" *ngFor="let ris of visualRis">
        <mat-accordion class="school-results-accordion">
          <mat-expansion-panel hideToggle class="school-results-panel" [ngStyle]="{
                background: ris.iscritti.length > 0 ? 'ligthgreen' : 'coral'
              }">
            <mat-expansion-panel-header class="school-results-panel-header">
              <mat-panel-title>
                {{ ris.scuola.nome }}
                {{ ris.scuola.regione }}
                {{ ris.scuola.provincia }}
                {{ ris.scuola.citta }}
                {{ annoVisual }}
              </mat-panel-title>
              <mat-panel-description class="school-results-subscription">
                Totale iscritti {{ ris.iscritti.length }}
              </mat-panel-description>
            </mat-expansion-panel-header>
            <div>
              <ng-container *ngFor="let a of ris.attivita">
                NomeAttività: {{ a.nomeAttivita }} Tipo: {{a.tipo}}<br />Partecipanti {{ a.partecipanti.length }},
                Iscritti {{ a.iscritti.length }}
                <br />
                <ng-container *ngFor="let i of a.iscritti">
                  {{ i.nome }} {{ i.cognome }}
                </ng-container>
                <br />
              </ng-container>
            </div>
            <div *ngIf="ris.iscritti.length > 0">
              Elenco Iscritti:<br>
              <ng-container *ngFor="let i of ris.iscritti">
                {{ i.nome }} {{ i.cognome }}
                <br />
              </ng-container>
            </div>
          </mat-expansion-panel>
        </mat-accordion>
      </div>
    </div>

    <div class="spazio" *ngIf="click == 2">
      <div class="activity-button">
        <button class="button-download" id="scaricaRisButton" (click)="scaricaVistarisulati()">
          <span class="button-content">Scarica Vista Risultati </span>
        </button>
      </div>

      <div class="activity-results" *ngFor="let ris of visualRisAtt">
        <mat-accordion class="activity-results-accordion">
          <mat-expansion-panel class="activity-results-panel" [ngStyle]="{
              background: ris.universitarii.length > 0 ? 'ligthgreen' : 'coral'
            }">
            <mat-expansion-panel-header class="activity-results-panel-header">
              <mat-panel-title>
                Attività: {{ ris.attivita }} Tipo:{{ris.tipo}} Anno {{ annoVisual }}
              </mat-panel-title>
              <mat-panel-description class="activty-results-subscription">
                Totale iscritti : {{ ris.universitarii.length }}
              </mat-panel-description>
            </mat-expansion-panel-header>
            <p *ngIf="ris.universitarii.length > 0">
              <ng-container *ngFor="let i of ris.universitarii">
                {{ i.nome }} {{ i.cognome }}
                <br />
              </ng-container>
            </p>
          </mat-expansion-panel>
        </mat-accordion>
      </div>
    </div>

    <div class="spazio" *ngIf="click == 3">
      <div class="school-prof-button">
        <button class="button-download" id="scaricaProfButton" (click)="scaricaVistaProfessori()">
          <span class="button-content">Scarica Vista Professori </span>
        </button>
      </div>

      <div class="school-prof-results" *ngFor="let p of profVisual">

        <mat-card>
          <mat-card-header class="school-prof-name">
            <h1>{{ p.professore.nome }} {{ p.professore.cognome }}</h1>
          </mat-card-header>
          <mat-card-content>
            email: {{ p.professore.email }}
            <br />
            scuola: {{ p.scuola.nome }}
            <br />
            città : {{ p.scuola.citta }}
            <br />
            regione : {{ p.scuola.regione }}
          </mat-card-content>
        </mat-card>
      </div>
    </div>

    <div class="spazio" *ngIf="click == 4">
      <div class="unicam-prof-button">
        <button class="button-download" id="scaricaProfUnicamButton" (click)="scaricaVistaProfessoriUnicam()">
          <span class="button-content">Scarica Vista Professori Unicam </span>
        </button>
      </div>

      <div class="unicam-prof-results" *ngFor="let p of profUnicamVisual">

        <mat-card>
          <mat-card-header class="unicam-prof-name">
            <h1>{{ p.professore.nome }} {{ p.professore.cognome }}</h1>
          </mat-card-header>
          <mat-card-content>
            email: {{ p.professore.email }}
            <br />
            nome: {{ p.professore.nome }}
            <br />
            cognome : {{ p.professore.cognome }}
          </mat-card-content>
        </mat-card>
      </div>
    </div>
  </div>
</div>